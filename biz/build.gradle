
apply plugin: 'java'
apply plugin: 'war'


configurations {
    compile.exclude group: 'org.springframework.boot', module: 'spring-boot-starter-tomcat'
    compile.exclude group: 'org.apache.tomcat'
    compile.exclude group: 'org.apache.tomcat.embed'
}


bootJar {
    manifest {
        attributes 'Start-Class': 'com.iscas.biz.BizApp'
    }
//    launchScript()
}

bootRun {
    main = 'com.iscas.biz.BizApp'
}

dependencies {
    compile project(":biz-base")
    compile project(":common:common-tools")

    /*compile project(":biz-ssh-server")*/
//    compile project(":special:biz-neo4j")


    //SSH客户端
//    compile project(":special:common-ssh-tools")

    //引入mybatis,如果引入了这个模块，
    compile project(":biz-mp")
    
    //引入jpa,如果引入了这个模块
//    compile project(":biz-jpa")

    testCompile group: 'org.springframework.boot', name: 'spring-boot-starter-test'

    compile 'com.corundumstudio.socketio:netty-socketio:1.7.7'

}

//打入本地maven库配置
install {
    repositories.mavenInstaller {
        pom.version="${project.version}"
        pom.artifactId="${project.archivesBaseName}"
        pom.groupId="${project.group}"
    }
}
bootBuildImage {
    imageName = "192.168.100.96:80/library/${project.name}:${project.version}"
    pullPolicy = "IF_NOT_PRESENT"
    builder = "paketobuildpacks/builder:base"
    publish = true
    docker {
        host = "tcp://192.168.100.91:2375"
        tlsVerify = false
//        certPath = "/home/users/.minikube/certs"
        publishRegistry {
            username = "admin"
            password = "Harbor12345"
            url = "http://192.168.100.96"
            email = "76775081@qq.com"
        }
    }
}
