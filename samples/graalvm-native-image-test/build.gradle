

dependencies {
    api('org.springframework.boot:spring-boot-starter-web')
    testImplementation group: 'org.springframework.boot', name: 'spring-boot-starter-test'
    api 'org.springframework.experimental:spring-graalvm-native:0.8.5'
    api 'org.springframework:spring-context-indexer'
}

jar {
    enabled = true
}

bootJar {
    manifest {
        attributes 'Start-Class': 'com.iscas.graalvm.nativeImage.test.App'
        attributes 'Main-Class': 'com.iscas.graalvm.nativeImage.test.App'
    }
//    launchScript()
}

bootBuildImage {
    imageName = "192.168.100.96:80/library/${project.name}:0.0.2"
    publish = true
    builder = "paketobuildpacks/builder:tiny"
    environment = [
            "BP_BOOT_NATIVE_IMAGE" : "1",
            "BP_BOOT_NATIVE_IMAGE_BUILD_ARGUMENTS": "-Dspring.spel.ignore=true -Dspring.native.remove-yaml-support=true"
    ]
    docker {
        host = "tcp://192.168.100.91:2375"
        tlsVerify = false
//        certPath = "/home/users/.minikube/certs"
        publishRegistry {
            username = "admin"
            password = "Harbor12345"
            url = "http://192.168.100.96"
            email = "76775081@qq.com"
        }
    }
}

